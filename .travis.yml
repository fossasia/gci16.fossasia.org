language: ruby
cache: bundler
services: docker
rvm:
  - 2.3.3
install:
  - gem install danger
  - gem install fastimage
  - danger --verbose
  - bundle install
env:
  - TEST=bundle exec jekyll build
  - TEST=percy snapshot _site/
  - TEST=ruby ./scripts/ImgChecker/ImgChecker.rb
  - TEST=docker run --volume=$(pwd):/app --workdir=/app coala/base coala -C
script: "$TEST"
branches:
  only:
    - gh-pages  # Must be appear explicitly
    - /./  # Allows builds for any other branch name
